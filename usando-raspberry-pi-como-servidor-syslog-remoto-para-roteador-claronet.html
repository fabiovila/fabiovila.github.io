<!DOCTYPE html><html lang="pt-br"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="https://fabiovila.github.io/assets/css/high/github.css?v=754087c48785d8bc80b61b25cfa9f397"><script src="https://fabiovila.github.io/assets/js/highlight.min.js?v=794898ca191671a50f3d9908f4fa4815"></script><title>Usando Raspberry Pi como servidor syslog remoto para roteador Claro/NET - Fabio</title><meta name="description" content="Descobri esses dias que meu roteador Claro/NET tem a opção de log&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://fabiovila.github.io/usando-raspberry-pi-como-servidor-syslog-remoto-para-roteador-claronet.html"><link rel="alternate" type="application/atom+xml" href="https://fabiovila.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://fabiovila.github.io/feed.json"><meta property="og:title" content="Usando Raspberry Pi como servidor syslog remoto para roteador Claro/NET"><meta property="og:site_name" content="Fabio"><meta property="og:description" content="Descobri esses dias que meu roteador Claro/NET tem a opção de log&hellip;"><meta property="og:url" content="https://fabiovila.github.io/usando-raspberry-pi-como-servidor-syslog-remoto-para-roteador-claronet.html"><meta property="og:type" content="article"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="https://fabiovila.github.io/assets/css/style.css?v=769d7954b2b61cff57f960f9c5e4e9fd"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://fabiovila.github.io/usando-raspberry-pi-como-servidor-syslog-remoto-para-roteador-claronet.html"},"headline":"Usando Raspberry Pi como servidor syslog remoto para roteador Claro/NET","datePublished":"2021-07-09T20:56","dateModified":"2021-07-24T11:30","description":"Descobri esses dias que meu roteador Claro/NET tem a opção de log&hellip;","author":{"@type":"Person","name":"Fabio"},"publisher":{"@type":"Organization","name":"Fabio"}}</script><script>MathJax = {
  tex: {
    inlineMath: [['$', '$']]
  }
};</script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>hljs.highlightAll();</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PY9DT1RWSW"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-PY9DT1RWSW');</script></head><body><div class="container"><header class="header"><a href="https://fabiovila.github.io/" class="logo">Fabio</a></header><main><article class="post wrapper"><header class="hero"><p class="post__meta">By <a href="https://fabiovila.github.io/authors/fabio/" rel="author" title="Fabio">Fabio</a> Published on <time datetime="2021-07-09T20:56">julho 9, 2021</time></p><h1 class="post__title">Usando Raspberry Pi como servidor syslog remoto para roteador Claro/NET</h1></header><div class="post__entry"><p>Descobri esses dias que meu roteador Claro/NET tem a opção de log remoto aproveitei então e configurei meu Raspberry PI como servidor remoto syslog do roteador. Neste artigo vou ensinar como colocar seu Raspberry PI e extensível a outras placas ou computadores rodando Linux como servidor syslog remoto e configurar o roteador Claro/NET para emitir logs para esse servidor.</p><h2>Configurando rsyslog</h2><p>O servidor syslog usado será o rsyslog que já vem por padrão instalado no Raspberry PI OS serão apenas criar e mudar alguns arquivos.</p><h2>Habilitando o servidor na porta 514 no RPI</h2><p>Para habilitar o servidor rsyslog na port 514 edite o arquivo<code>/etc/rsyslog.conf</code> e descomente as seguintes linhas:</p><pre><code># provides UDP syslog reception<br>module(load="imudp")<br>input(type="imudp" port="514")<br><br># provides TCP syslog reception<br>module(load="imtcp")<br>input(type="imtcp" port="514")</code></pre><h2>Criando o arquivo de log</h2><p>Você terá que especificar o arquivo e local que o log será acumulado, para isso crie o arquivo de log em /var/log com o nome desejado como no exemplo abaixo:</p><pre><code>$ sudo touch /var/log/claro.log</code></pre><h2>Configurando o rsyslog para seu arquivo de log</h2><p>Agora é hora de criar um arquivo com qualquer nome mas terminado em <code>.conf</code>no local <code>/etc/rsyslog.d/</code> que indicará no arquivo de log e o IP do cliente (o roteador) que produzirá os logs:</p><pre> <code class="language-shell" data-lang="shell">$template NetworkLog, "/var/log/claro.log"<br>:fromhost-ip, isequal, "192.168.0.1" -?NetworkLog<br>&amp; stop</code></pre><p>Veja que <code>"/var/log/claro.log"</code> deverá ser igual ao arquivo criado do passo anterior e o IP o IP do seu roteador.</p><h2>Rotate</h2><p>Não é uma boa deixar o log crescer indefinidamente, então é melhor configurar o rotate do arquivo impondo um limite. Crie um arquivo com qualquer nome em /etc/logrotate.d/ e coloque o texto abaixo:</p><pre><code class="language-shell" data-lang="shell">/var/log/claro.log { 
        rotate 7
        size 500k
        notifempty
        compress
        postrotate
                invoke-rc.d rsyslog rotate &gt; /dev/null
        endscript
    }</code></pre><h2>Reiniciando o rsyslog</h2><p>Finalmente reinicie o rsyslog:</p><pre><code class="language-shell" data-lang="shell">$ sudo service rsyslog restart</code></pre><h2>Configurando o Roteador Claro/NET</h2><p>Para configurar o roteador você deverá estar logado entrar em <strong>Configurações Avançadas </strong>e no Menu que aparecerá seguir o caminho <strong>Menu &gt; Segurança &gt; Firewall &gt; Log</strong> Remoto e a seguinte página será exibida:</p><figure class="post__image"><img loading="lazy" src="https://fabiovila.github.io/media/posts/7/Captura-de-tela-de-2021-07-09-21-09-27.png" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://fabiovila.github.io/media/posts/7/responsive/Captura-de-tela-de-2021-07-09-21-09-27-xs.png 300w, https://fabiovila.github.io/media/posts/7/responsive/Captura-de-tela-de-2021-07-09-21-09-27-sm.png 480w, https://fabiovila.github.io/media/posts/7/responsive/Captura-de-tela-de-2021-07-09-21-09-27-md.png 768w, https://fabiovila.github.io/media/posts/7/responsive/Captura-de-tela-de-2021-07-09-21-09-27-lg.png 1024w" alt="Tela de configuração do roteador" width="876" height="1019"><figcaption>Tela de configuração de LOG do roteador da Claro</figcaption></figure><p>No campo <strong>192.168.0.[   ]</strong> você deverá preencher com o final do IP do raspberry-pi rodando o rsyslog; escolher a opção "<strong>PARA SERVIDOR SYSLOG EM:</strong>" e finalmente nas opções de log desejadas.</p><p>A quantidade de logs produzidas é grande.</p><p> </p></div><footer class="post__footer"><div class="post__last-updated">This article was updated on julho 24, 2021</div><div class="post__footer__col"><ul class="post__tag"><li><a href="https://fabiovila.github.io/raspberry-pi/">raspberry-pi</a></li><li><a href="https://fabiovila.github.io/rsyslog/">rsyslog</a></li><li><a href="https://fabiovila.github.io/seguranca/">segurança</a></li></ul><div class="post__share"><a href="https://api.whatsapp.com/send?text=Usando%20Raspberry%20Pi%20como%20servidor%20syslog%20remoto%20para%20roteador%20Claro%2FNET https%3A%2F%2Ffabiovila.github.io%2Fusando-raspberry-pi-como-servidor-syslog-remoto-para-roteador-claronet.html" class="js-share whatsapp" aria-label="Share with Whats App" rel="nofollow noopener noreferrer"><svg class="icon"><use xlink:href="https://fabiovila.github.io/assets/svg/svg-map.svg#whatsapp"/></svg></a></div></div><nav class="post__nav"><div class="post__nav__prev">Previous Post<h5><a href="https://fabiovila.github.io/rede-neural-em-python-numpy-para-iris-dataset.html" class="inverse" rel="prev">Rede neural em python numpy para iris dataset</a></h5></div><div class="post__nav__next">Next Post<h5><a href="https://fabiovila.github.io/usando-python-para-solucionar-ode-em-circuitos-eletricos.html" class="inverse" rel="next">Usando Python para ODEs de circuitos elétricos: RL</a></h5></div></nav><div class="post__bio"><div><h3><a href="https://fabiovila.github.io/authors/fabio/" class="inverse" title="Fabio">Fabio</a></h3></div></div><div class="post__related"><h3 class="u-h5">Related posts</h3><div class="post__related__wrap"><figure><figcaption><h4><a href="https://fabiovila.github.io/usando-python-para-solucionar-ode-em-circuitos-eletricos.html" class="inverse">Usando Python para ODEs de circuitos elétricos: RL</a></h4><time datetime="2021-12-18T20:37">dezembro 18, 2021</time></figcaption></figure><figure><a href="https://fabiovila.github.io/rede-neural-em-python-numpy-para-iris-dataset.html"><img src="https://fabiovila.github.io/media/posts/6/responsive/Captura-de-tela-de-2021-06-02-14-23-17-xs.png" loading="lazy" alt=""></a><figcaption><h4><a href="https://fabiovila.github.io/rede-neural-em-python-numpy-para-iris-dataset.html" class="inverse">Rede neural em python numpy para iris dataset</a></h4><time datetime="2021-06-02T11:41">junho 2, 2021</time></figcaption></figure><figure><a href="https://fabiovila.github.io/o-cvxpy-para-o-problema-de-mochila-knapsack.html"><img src="https://fabiovila.github.io/media/posts/1/responsive/Screenshot-from-2021-05-15-17-39-07-2-xs.png" loading="lazy" alt=""></a><figcaption><h4><a href="https://fabiovila.github.io/o-cvxpy-para-o-problema-de-mochila-knapsack.html" class="inverse">O CVXPY para o problema de mochila (knapsack)</a></h4><time datetime="2020-07-26T15:35">julho 26, 2020</time></figcaption></figure></div></div></footer></article></main><div id="disqus_thread"></div><script>var disqus_config = function () {
    this.page.url = "";  
    this.page.identifier = ""; 
    };
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://fabiovila-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><footer class="footer"><div class="footer__copyright">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></div></footer></div><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.navbar'};</script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>